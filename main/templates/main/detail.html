{% extends 'base.html' %}
{% load static %}

{% block content %}
<h2>{{ post.headline }}</h2>



<a href="{% url 'users:mypage' post.author.id %}"><strong>ì‘ì„±ì:</strong> {{ post.author.username }}</a>
<p><strong>ê°ì • ìƒíƒœ:</strong> {{ post.mood }}</p>
<p><strong>ì‘ì„± ì‹œê°„:</strong> {{ post.created_at|date:"Yë…„ mì›” dì¼ H:i" }}</p>

<a href="{% url 'main:likes' post.id %}">
    {% if user in post.like.all %} ì·¨ì†Œ {% else %} ì¢‹ì•„ìš” {% endif %}
</a>
{{post.like_count}}ê°œ

{% if post.tags.exists %}
<p><strong>í•´ì‹œíƒœê·¸:</strong>
    {% for tag in post.tags.all %}
        <a href="{% url 'main:tag-posts' tag.id %}">#{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
    {% endfor %}
</p>
{% endif %}

{% if post.photo %}
<p><img src="{{ post.photo.url }}" alt="ì²¨ë¶€ ì´ë¯¸ì§€" width="300px"></p>
{% endif %}

<hr>

<p style="white-space: pre-wrap;">{{ post.reflection }}</p>

<a href="{% url 'main:secondpage' %}">â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>

{% if user == post.author %}
<a href="{% url 'main:edit' post.id %}">| ê¸€ ìˆ˜ì •í•˜ê¸°</a>
<a href="{% url 'main:delete' post.id %}" onclick="return confirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?');">| ğŸ—‘ ì‚­ì œí•˜ê¸°</a>
{% endif %}


<h3>ğŸ’¬ ëŒ“ê¸€</h3>
{% for comment in comments %}
<div style="border-top: 1px solid #ccc; padding: 10px 0;">
    <p><strong>{{ comment.writer.username }}</strong> | {{ comment.pub_date|date:"Y-m-d H:i" }}</p>
    <p>{{ comment.content }}</p>

    {% if user == comment.writer %}
    <form action="{% url 'main:comment_delete' comment.id %}" method="POST" style="display:inline;">
        {% csrf_token %}
        <button type="submit" onclick="return confirm('ëŒ“ê¸€ì„ ì‚­ì œí• ê¹Œìš”?')">âŒ ëŒ“ê¸€ ì‚­ì œí•˜ê¸°</button>
    </form>
    {% endif %}
</div>
{% empty %}
<p>ì•„ì§ ëŒ“ê¸€ì´ ì—†ì–´ìš” ğŸ¥²</p>
{% endfor %}


{% if user.is_authenticated %}
<hr>
<form action="{% url 'main:detail' post.id %}" method="POST">
    {% csrf_token %}
    <textarea name="content" rows="3" cols="40" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea><br>
    <button type="submit">ëŒ“ê¸€ ì‘ì„±</button>
</form>
{% else %}
<p>âœ ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ <a href="{% url 'accounts:login' %}">ë¡œê·¸ì¸</a> í•´ì£¼ì„¸ìš”.</p>
{% endif %}




{% endblock %}